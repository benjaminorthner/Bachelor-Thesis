\section{Non-local Coulomb Interactions} \label{sec:non_local_coulomb}

One of the goals of this thesis is to expand the capabilities of the existing code to include non-local coulomb interactions. This will allow for more true to life representations of electron systems. In the case of a benzene ring for example, non-local interactions play a vital role and are absolutely necessary if one hopes to reproduce experimental results. 

\bigskip

In the existing implementation the on-site repulsive coulomb force is accounted for in the Hamiltonian as
\begin{equation}
    \hat{H}=\underbrace{{\color{red!70!black} U} \sum_{i} \hat{n}_{i \uparrow} \hat{n}_{i \downarrow}}_{\text{Potential Energy}}+%
    \underbrace{\sum_{i j \sigma} v_{j i} \hat{c}_{i \sigma}^{\dagger} \hat{c}_{j \sigma}}_{\text{Kinetic Energy}}\label{eq:local_ham_nonsym}
\end{equation}

 The extension to nonlocal coulomb interactions follows naturally
 \begin{equation}
    \hat{H}= \sum_{ij\sigma\sigma'}{\color{red!70!black} U_{ij\sigma\sigma'}}\hat{n}_{i \sigma} \hat{n}_{j\sigma'}+%
    \sum_{i j \sigma} v_{j i} \hat{c}_{i \sigma}^{\dagger} \hat{c}_{j \sigma}%
    \label{eq:ham_nonsym}
\end{equation}
Because only the mutual orientation of the spins $\sigma$ and $\sigma'$ can have a physical effects, we can split $U_{ij\sigma\sigma'}$ into two $N_s\times N_s$ matrices $U_{ij}^{\text{same-spin}}$ and $U_{ij}^{\text{opp-spin}}$. These must be generated for each system geometry and then be passed as parameters to the Hamiltonian assembly routine. For all results shown in this thesis $U^{\text{same-spin}}$ and $U^{\text{opp-spin}}$ have been chosen to be identical in their off-diagonal elements. Due to the Pauli exclusion principle the diagonal elements of $U^{\text{same-spin}}$ must be set to $0$, as two electrons with equal spins can not occupy the same site.


\subsection{Electron-Hole Symmetry and Chemical Potential}
\subsubsection{Local U}
In the current form, this Hamiltonian changes differently upon addition of an electron compared to an addition of a hole. However, it will later prove to be rather useful to have the Hamiltonian be electron-hole symmetric, and ideally take the following form
\begin{equation}
    \hat{H} = U \sum_i \left(\hat{n}_{i\uparrow}-\frac{1}{2}\right)\left(\hat{n}_{i\downarrow}-\frac{1}{2}\right)+\sum_{i j \sigma} v_{j i} \hat{c}_{i \sigma}^{\dagger} \hat{c}_{j \sigma}\label{eq:local_ham_sym}
\end{equation}
The numerical implementation of (\ref{eq:local_ham_sym}) is however less practical. We can however achieve electron-hole symmetry while still using (\ref{eq:local_ham_nonsym}) by setting the value for the chemical potential to $v_{ii} = -U / 2$.
\medskip

\subsubsection{Non-Local U}
Electron hole symmetry is again achieved via a choice of chemical potential (hartree term?). Sum over any row of both U matrices ({\color{red}different for qd and benzene})
\begin{equation}
    v_{ii} = - \frac{1}{2}\sum_{j} U_{0j}^{\text{opp-spin}} + U_{0j}^{\text{same-spin}}
\end{equation}


\subsubsection{Pariser-Parr-Pople Model}\label{subsec:ppp}

The Pariser-Parr-Pople model (PPP) aims to simplify the Hamiltonian of single band $\pi$- electron systems, such as the one of the molecule benzene, to a form which is diagonalisable. It's Hamiltonian in electron-hole symmetric form is

\begin{equation}
    \mathcal{H}_{PPP} = \underbrace{-t \sum_{\langle ij \rangle \sigma} \left(\hat{c}^\dagger_{i\sigma}\hat{c}_{j\sigma} + h.c.\right) 
    }_{\text{hopping terms}}
    + \underbrace{U \sum_i \left(\hat{n}_{i\uparrow} - \frac{1}{2}\right)\left(\hat{n}_{i\downarrow} - \frac{1}{2}\right)
    }_{\text{local coulomb interaction}}
    + \underbrace{\frac{1}{2}\sum_{i\neq j} U_{ij} \bigg(\hat{n}_{i} - 1\bigg)\bigg(\hat{n}_{i} - 1\bigg)
    }_{\text{non-Local Coulomb interactions}}
\end{equation}
Here $\langle \cdot\cdot\cdot \rangle$ indicates nearest neighbour hoppings and $\hat{n}_i = \hat{n}_{i\uparrow} + \hat{n}_{i\downarrow}$
\\

{\color{red} Q: We do not use this form in the code... instead we simply add $U$ and $U_{ij}$ wherever there is an interaction present... and on top of that we have an on-site hopping term a Hartree term... How would I write about this? Also Paul had a derivation of this Hartree term using some Feynmann diagram stuff... Should I write about that?}
\\

We model the energy of the non-local coulomb interaction using the Ohno parametrisation of the coulomb interaction  \cite{ppp_ohno, hoerbinger}
\begin{equation}
    U_{ij} = \frac{U}{\sqrt{1 + \alpha |r_{ij}|^2}} \quad \text{where} \quad \alpha = \left(\frac{4\pi\varepsilon_0 U}{e^2} \right)^2 \label{eq:ohno_interpolation}
\end{equation}
where $|r_{ij}|$ is the distance between two sites. This ensures that at long ranges, $r_{ij}\to\infty$, $U_{ij}$ gives the standard Coulomb interaction energy, and at short ranges, $r_{ij}\to 0$, we get the on-site coulomb interaction $U_{ij} = U_{ii} =: U$ 

\subsection{Potential Energy as a Measure for Impact Ionisation}
In the preceding works \cite{innerberger,worm_bachelor,worm_project,prauhart}, impact ionisation was studied by looking at how the expectation value of the ``site averaged double occupation'' changed over time, after the initial excitation by the light pulse.
\begin{equation}
    \left\langle{\hat{d}(t)}\right\rangle = \frac{1}{N_s}\sum_i \braket{\hat{n}_{i\uparrow}(t)\hat{n}_{i\downarrow}(t)}
\end{equation}

However the use of this observable was only valid because it happened to be proportional to the potential energy term in the system's Hamiltonian (\ref{eq:local_ham_nonsym}). The true measure for impact ionisation is in fact the rate of conversion of the system's kinetic energy to it's potential energy, for a constant total energy.

\medskip
In a sense this is the very definition of impact ionisation. In ordinary systems any excess kinetic energy is lost to phonon excitations. Converting this kinetic energy into potential energy, for example by lifting another electron to a higher energy level, is what we call impact ionisation.
\medskip

In transitioning to a Hamiltonian with non-local coulomb interactions (\ref{eq:ham_nonsym}) the proportionality between double occupation and potential energy is lost. Thus a new function was implemented that calculates the site-averaged expectation value of the potential energy at every time-step. In the code this is also referred to as the ``interaction energy''
\begin{equation}
    \left\langle{\hat{E}_{\text{pot}}(t)}\right\rangle = \frac{1}{N_s} \sum_{ij\sigma\sigma'} \left\langle{U_{ij\sigma\sigma'}\hat{n}_{i \sigma}(t) \hat{n}_{j\sigma'}(t)}\right\rangle
\end{equation}
Since $\hat{E}_{\text{pot}}$ commutes with the Hamiltonian, the occupation number basis states are also eigenstates of $\hat{E}_{\text{pot}}$. Thus $\left\langle{\hat{E}_{\text{pot}}(t)}\right\rangle$ can be calculated by taking the trace of the Hamiltonian. The on-site hopping term $v_{ii}$ will also be included in the trace, however it only contributes a constant shift (that we interpret as a chemical potential), and thus has no effect on impact ionisation which depends on the rate of change of the potential energy.

\color{red}
potentially include some sort of pseudocode for how the interaction energy is calcualted. Would include that at every time step we first extract the sparse hamiltonians diagonal (could also be shown in pseudocode), and then calculate the trace of the ground state vector with just the diagonal in a non spares vector vector multiplication. (mention that this leads to problem that we can not distinguish between QD and Benzene in result?)
\color{black}

\begin{algorithm}
\caption{An algorithm with caption}\label{alg:cap}
\hspace*{\algorithmicindent} \textbf{Input:} $H$ \\
\hspace*{\algorithmicindent} \textbf{Output:} $H_{\textbf{diagonal}}$
\begin{algorithmic}[1]
\For{$r = 0$ \textbf{to} $H.\textbf{dim}$} \Comment{Loop through rows in Hamiltonian}
    \State
    \State
\EndFor
\If{$N$ is even}
    \State $X \gets X \times X$
    \State $N \gets \frac{N}{2}$  \Comment{This is a comment}
\ElsIf{$N$ is odd}
    \State $y \gets y \times X$
    \State $N \gets N - 1$
\EndIf
\EndWhile
\end{algorithmic}
\end{algorithm}